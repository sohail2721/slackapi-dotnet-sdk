// <copyright file="WorkflowsController.cs" company="APIMatic">
// SlackWebApi.Standard
//
// This file was automatically generated by APIMATIC v3.0 ( https://www.apimatic.io ).
// </copyright>
using APIMatic.Core;
using APIMatic.Core.Utilities;
using SlackWebApi.Standard.Exceptions;
using SlackWebApi.Standard.Http.Response;
using System.Net.Http;
using System.Threading;
using System.Threading.Tasks;

namespace SlackWebApi.Standard.Controllers
{
    /// <summary>
    /// WorkflowsController.
    /// </summary>
    public class WorkflowsController : BaseController
    {
        /// <summary>
        /// Initializes a new instance of the <see cref="WorkflowsController"/> class.
        /// </summary>
        internal WorkflowsController(GlobalConfiguration globalConfiguration) : base(globalConfiguration) { }

        /// <summary>
        /// Indicate that an app's step in a workflow completed execution.
        /// </summary>
        /// <param name="token">Required parameter: Authentication token. Requires scope: `workflow.steps:execute`.</param>
        /// <param name="workflowStepExecuteId">Required parameter: Context identifier that maps to the correct workflow step execution..</param>
        /// <param name="outputs">Optional parameter: Key-value object of outputs from your step. Keys of this object reflect the configured `key` properties of your [`outputs`](/reference/workflows/workflow_step#output) array from your `workflow_step` object..</param>
        /// <returns>Returns the ApiResponse of Models.DefaultSuccessTemplate response from the API call.</returns>
        public ApiResponse<Models.DefaultSuccessTemplate> WorkflowsStepCompleted(
                string token,
                string workflowStepExecuteId,
                string outputs = null)
            => CoreHelper.RunTask(WorkflowsStepCompletedAsync(token, workflowStepExecuteId, outputs));

        /// <summary>
        /// Indicate that an app's step in a workflow completed execution.
        /// </summary>
        /// <param name="token">Required parameter: Authentication token. Requires scope: `workflow.steps:execute`.</param>
        /// <param name="workflowStepExecuteId">Required parameter: Context identifier that maps to the correct workflow step execution..</param>
        /// <param name="outputs">Optional parameter: Key-value object of outputs from your step. Keys of this object reflect the configured `key` properties of your [`outputs`](/reference/workflows/workflow_step#output) array from your `workflow_step` object..</param>
        /// <param name="cancellationToken"> cancellationToken. </param>
        /// <returns>Returns the ApiResponse of Models.DefaultSuccessTemplate response from the API call.</returns>
        public async Task<ApiResponse<Models.DefaultSuccessTemplate>> WorkflowsStepCompletedAsync(
                string token,
                string workflowStepExecuteId,
                string outputs = null,
                CancellationToken cancellationToken = default)
            => await CreateApiCall<Models.DefaultSuccessTemplate>()
              .RequestBuilder(requestBuilder => requestBuilder
                  .Setup(HttpMethod.Get, "/workflows.stepCompleted")
                  .WithAuth("slackAuth")
                  .Parameters(parameters => parameters
                      .Header(header => header.Setup("token", token).Required())
                      .Query(query => query.Setup("workflow_step_execute_id", workflowStepExecuteId).Required())
                      .Header(header => header.Setup("Content-Type", "application/x-www-form-urlencoded"))
                      .Query(query => query.Setup("outputs", outputs))))
              .ResponseHandler(responseHandler => responseHandler
                  .ErrorCase("0", CreateErrorCase("Typical error response", (errorReason, context) => new DefaultErrorTemplateException(errorReason, context))))
              .ExecuteAsync(cancellationToken).ConfigureAwait(false);

        /// <summary>
        /// Indicate that an app's step in a workflow failed to execute.
        /// </summary>
        /// <param name="token">Required parameter: Authentication token. Requires scope: `workflow.steps:execute`.</param>
        /// <param name="workflowStepExecuteId">Required parameter: Context identifier that maps to the correct workflow step execution..</param>
        /// <param name="error">Required parameter: A JSON-based object with a `message` property that should contain a human readable error message..</param>
        /// <returns>Returns the ApiResponse of Models.DefaultSuccessTemplate response from the API call.</returns>
        public ApiResponse<Models.DefaultSuccessTemplate> WorkflowsStepFailed(
                string token,
                string workflowStepExecuteId,
                string error)
            => CoreHelper.RunTask(WorkflowsStepFailedAsync(token, workflowStepExecuteId, error));

        /// <summary>
        /// Indicate that an app's step in a workflow failed to execute.
        /// </summary>
        /// <param name="token">Required parameter: Authentication token. Requires scope: `workflow.steps:execute`.</param>
        /// <param name="workflowStepExecuteId">Required parameter: Context identifier that maps to the correct workflow step execution..</param>
        /// <param name="error">Required parameter: A JSON-based object with a `message` property that should contain a human readable error message..</param>
        /// <param name="cancellationToken"> cancellationToken. </param>
        /// <returns>Returns the ApiResponse of Models.DefaultSuccessTemplate response from the API call.</returns>
        public async Task<ApiResponse<Models.DefaultSuccessTemplate>> WorkflowsStepFailedAsync(
                string token,
                string workflowStepExecuteId,
                string error,
                CancellationToken cancellationToken = default)
            => await CreateApiCall<Models.DefaultSuccessTemplate>()
              .RequestBuilder(requestBuilder => requestBuilder
                  .Setup(HttpMethod.Get, "/workflows.stepFailed")
                  .WithAuth("slackAuth")
                  .Parameters(parameters => parameters
                      .Header(header => header.Setup("token", token).Required())
                      .Query(query => query.Setup("workflow_step_execute_id", workflowStepExecuteId).Required())
                      .Query(query => query.Setup("error", error).Required())
                      .Header(header => header.Setup("Content-Type", "application/x-www-form-urlencoded"))))
              .ResponseHandler(responseHandler => responseHandler
                  .ErrorCase("0", CreateErrorCase("Typical error response", (errorReason, context) => new DefaultErrorTemplateException(errorReason, context))))
              .ExecuteAsync(cancellationToken).ConfigureAwait(false);

        /// <summary>
        /// Update the configuration for a workflow extension step.
        /// </summary>
        /// <param name="token">Required parameter: Authentication token. Requires scope: `workflow.steps:execute`.</param>
        /// <param name="workflowStepEditId">Required parameter: A context identifier provided with `view_submission` payloads used to call back to `workflows.updateStep`..</param>
        /// <param name="inputs">Optional parameter: A JSON key-value map of inputs required from a user during configuration. This is the data your app expects to receive when the workflow step starts. **Please note**: the embedded variable format is set and replaced by the workflow system. You cannot create custom variables that will be replaced at runtime. [Read more about variables in workflow steps here](/workflows/steps#variables)..</param>
        /// <param name="outputs">Optional parameter: An JSON array of output objects used during step execution. This is the data your app agrees to provide when your workflow step was executed..</param>
        /// <param name="stepName">Optional parameter: An optional field that can be used to override the step name that is shown in the Workflow Builder..</param>
        /// <param name="stepImageUrl">Optional parameter: An optional field that can be used to override app image that is shown in the Workflow Builder..</param>
        /// <returns>Returns the ApiResponse of Models.DefaultSuccessTemplate response from the API call.</returns>
        public ApiResponse<Models.DefaultSuccessTemplate> WorkflowsUpdateStep(
                string token,
                string workflowStepEditId,
                string inputs = null,
                string outputs = null,
                string stepName = null,
                string stepImageUrl = null)
            => CoreHelper.RunTask(WorkflowsUpdateStepAsync(token, workflowStepEditId, inputs, outputs, stepName, stepImageUrl));

        /// <summary>
        /// Update the configuration for a workflow extension step.
        /// </summary>
        /// <param name="token">Required parameter: Authentication token. Requires scope: `workflow.steps:execute`.</param>
        /// <param name="workflowStepEditId">Required parameter: A context identifier provided with `view_submission` payloads used to call back to `workflows.updateStep`..</param>
        /// <param name="inputs">Optional parameter: A JSON key-value map of inputs required from a user during configuration. This is the data your app expects to receive when the workflow step starts. **Please note**: the embedded variable format is set and replaced by the workflow system. You cannot create custom variables that will be replaced at runtime. [Read more about variables in workflow steps here](/workflows/steps#variables)..</param>
        /// <param name="outputs">Optional parameter: An JSON array of output objects used during step execution. This is the data your app agrees to provide when your workflow step was executed..</param>
        /// <param name="stepName">Optional parameter: An optional field that can be used to override the step name that is shown in the Workflow Builder..</param>
        /// <param name="stepImageUrl">Optional parameter: An optional field that can be used to override app image that is shown in the Workflow Builder..</param>
        /// <param name="cancellationToken"> cancellationToken. </param>
        /// <returns>Returns the ApiResponse of Models.DefaultSuccessTemplate response from the API call.</returns>
        public async Task<ApiResponse<Models.DefaultSuccessTemplate>> WorkflowsUpdateStepAsync(
                string token,
                string workflowStepEditId,
                string inputs = null,
                string outputs = null,
                string stepName = null,
                string stepImageUrl = null,
                CancellationToken cancellationToken = default)
            => await CreateApiCall<Models.DefaultSuccessTemplate>()
              .RequestBuilder(requestBuilder => requestBuilder
                  .Setup(HttpMethod.Get, "/workflows.updateStep")
                  .WithAuth("slackAuth")
                  .Parameters(parameters => parameters
                      .Header(header => header.Setup("token", token).Required())
                      .Query(query => query.Setup("workflow_step_edit_id", workflowStepEditId).Required())
                      .Header(header => header.Setup("Content-Type", "application/x-www-form-urlencoded"))
                      .Query(query => query.Setup("inputs", inputs))
                      .Query(query => query.Setup("outputs", outputs))
                      .Query(query => query.Setup("step_name", stepName))
                      .Query(query => query.Setup("step_image_url", stepImageUrl))))
              .ResponseHandler(responseHandler => responseHandler
                  .ErrorCase("0", CreateErrorCase("Typical error response", (errorReason, context) => new DefaultErrorTemplateException(errorReason, context))))
              .ExecuteAsync(cancellationToken).ConfigureAwait(false);
    }
}